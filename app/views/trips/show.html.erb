<h1>Trip: <%= @trip.name %></h1>
<h3><p id ='destination'><%= @trip.destination_name %></h3></p>
<h3><%= @trip.destination_address %></h3>

<section class="climbs">
  <h1>Climbs</h1>
    <% @trip.climbs.each do |climb| %>
      <section id="climb-<%= climb.id%>">
        <%= link_to climb.name, climb.url %>
      </section>
    <% end %>
</section>


<div id="map"></div>
<script type="text/javascript">
  function initMap() {
    var destinationCoords = new google.maps.LatLng(<%= @trip.lat %>, <%= @trip.lng %>);

    var mapOptions = {
      center: destinationCoords,
      zoom: 8,
      disableDefaultUI: true
    };

    var map = new google.maps.Map(document.getElementById('map'), mapOptions);

    var marker = new google.maps.Marker({
      position: destinationCoords,
      map: map,
      title: "<%= @trip.destination_name %>"
    });

    <% @trip.climbs.each_with_index do |climb, index| %>
      climbCoords<%= index %> = new google.maps.LatLng(<%= climb.lat %>, <%= climb.lng %>);
       var climbMarker<%= index %> = new google.maps.Marker({
         position: climbCoords<%= index %>,
         map: map,
         title: "<%= climb.name%>",
         icon: {
  url: "http://maps.google.com/mapfiles/ms/icons/blue-dot.png"                           }
       })

       google.maps.event.addListener(climbMarker<%= index %>, 'click', function () {
         document.getElementById("climb-<%= climb.id %>").style.fontSize = "35px";
         document.getElementById("climb-<%= climb.id %>").style.color = "red";

       });
    <% end %>


    google.maps.event.addListener(marker, 'click', function () {
      document.getElementById("destination").style.fontSize = "35px";
      document.getElementById("destination").style.color = "red";
    });
  }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=<%=ENV['GOOGLE_MAP_API']%>&callback=initMap"
async defer></script>
